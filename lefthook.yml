# Lefthookè¨­å®š - äºŒæ®µéšCI
# commitæ™‚: è»½é‡ãªãƒã‚§ãƒƒã‚¯ï¼ˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã€ãƒªãƒ³ãƒˆã€å‹ãƒã‚§ãƒƒã‚¯ï¼‰
# pushæ™‚: é‡ã„ãƒã‚§ãƒƒã‚¯ï¼ˆãƒ†ã‚¹ãƒˆï¼‰

pre-commit:
  parallel: true
  commands:
    type-check:
      run: bun run tsc
    biome-check:
      run: bunx biome check --write --files-ignore-unknown=true --no-errors-on-unmatched --error-on-warnings {staged_files}
      stage_fixed: true

pre-push:
  parallel: true
  commands:
    test:
      run: bun run test
    test-e2e:
      run: bun run test:e2e

# ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯
commit-msg:
  commands:
    check-commit-msg:
      run: |
        commit_regex='^(feat|fix|docs|style|refactor|test|chore|perf|build|ci)(\(.+\))?: .{1,100}$'
        # Skip validation for merge commits
        if grep -qE '^Merge ' {1}; then
          exit 0
        fi
        if ! grep -qE "$commit_regex" {1}; then
          echo "âŒ ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦ç´„ã«å¾“ã£ã¦ã„ã¾ã›ã‚“"
          echo "ğŸ“ å½¢å¼: <type>(<scope>): <subject>"
          echo "   ä¾‹: feat(calendar): Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºæ©Ÿèƒ½ã‚’è¿½åŠ "
          echo ""
          echo "ä½¿ç”¨å¯èƒ½ãªtype:"
          echo "  feat:     æ–°æ©Ÿèƒ½"
          echo "  fix:      ãƒã‚°ä¿®æ­£"
          echo "  docs:     ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã¿ã®å¤‰æ›´"
          echo "  style:    ã‚³ãƒ¼ãƒ‰ã®æ„å‘³ã«å½±éŸ¿ã—ãªã„å¤‰æ›´ï¼ˆç©ºç™½ã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç­‰ï¼‰"
          echo "  refactor: ãƒã‚°ä¿®æ­£ã‚„æ©Ÿèƒ½è¿½åŠ ã‚’ä¼´ã‚ãªã„ã‚³ãƒ¼ãƒ‰å¤‰æ›´"
          echo "  test:     ãƒ†ã‚¹ãƒˆã®è¿½åŠ ãƒ»ä¿®æ­£"
          echo "  chore:    ãƒ“ãƒ«ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã‚„ãƒ„ãƒ¼ãƒ«ã®å¤‰æ›´"
          echo "  perf:     ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„"
          echo "  build:    ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã‚„å¤–éƒ¨ä¾å­˜ã®å¤‰æ›´"
          echo "  ci:       CIè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å¤‰æ›´"
          exit 1
        fi 